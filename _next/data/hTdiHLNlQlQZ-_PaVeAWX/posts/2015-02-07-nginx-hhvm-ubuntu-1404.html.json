{"pageProps":{"postData":{"id":"2015-02-07-nginx-hhvm-ubuntu-1404.html","contentHtml":"<ol>\n<li>ติดตั้ง Nginx  </li>\n</ol>\n<blockquote>\n<p>sudo apt-get install nginx</p>\n</blockquote>\n<ol start=\"2\">\n<li>ติดตั้ง HHVM สำหรับ Linux distro อื่นๆ ดูได้ที่ <a href=\"https://github.com/facebook/hhvm/wiki/Prebuilt%20Packages%20for%20HHVM\">https://github.com/facebook/hhvm/wiki/Prebuilt%20Packages%20for%20HHVM</a>  </li>\n</ol>\n<p>ในบทความนี้ใช้ Ubuntu 14.04 ครับ  </p>\n<blockquote>\n<p>sudo apt-get install software-properties-common<br>\nsudo apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0x5a16e7281be7a449<br>\nsudo add-apt-repository 'deb <a href=\"http://dl.hhvm.com/ubuntu\">http://dl.hhvm.com/ubuntu</a> trusty main'<br>\nsudo apt-get update<br>\nsudo apt-get install hhvm</p>\n</blockquote>\n<ol start=\"3\">\n<li>เมื่อติดตั้งเสร็จเรียบร้อย HHVM จะขึ้นข้อความแนะนำวิธีการติดตั้ง fastcgi เพื่อให้ Apache  หรือ Nginx เรียกใช้งานได้ ดังภาพ  </li>\n</ol>\n<p><a href=\"http://3.bp.blogspot.com/-Uh5g-bARYnU/VNWyfDpQmNI/AAAAAAAAUb4/cseY3ktN-48/s1600/Screenshot-Terminal-5.png\"><img src=\"http://3.bp.blogspot.com/-Uh5g-bARYnU/VNWyfDpQmNI/AAAAAAAAUb4/cseY3ktN-48/s1600/Screenshot-Terminal-5.png\"></a>  </p>\n<ol start=\"4\">\n<li>Config ให้ HHVM เปิดใช้งานผ่านช่องทาง fastcgi โดยรัน Shell Script  </li>\n</ol>\n<blockquote>\n<p>/usr/share/hhvm/install_fastcgi.sh</p>\n</blockquote>\n<p><a href=\"http://3.bp.blogspot.com/-yBt-Wk_NDkw/VNWzlYFaRHI/AAAAAAAAUcA/CBSLguVZUdk/s1600/Screenshot-Terminal-6.png\"><img src=\"http://3.bp.blogspot.com/-yBt-Wk_NDkw/VNWzlYFaRHI/AAAAAAAAUcA/CBSLguVZUdk/s1600/Screenshot-Terminal-6.png\"></a>  </p>\n<ol start=\"5\">\n<li>restart HHVM daemon  </li>\n</ol>\n<blockquote>\n<p>sudo /etc/init.d/hhvm restart</p>\n</blockquote>\n<ol start=\"6\">\n<li>Config Nginx  ให้เรียกใช้งาน HHVM ผ่านทาง fastcgi<br>\nโดยเริ่มจากการสร้าง Virtual host ใน Nginx ให้ point ไปยัง path ที่ต้องการ โดยในตัวอย่างจะสร้าง Virtual host ที่ชื่อว่า hhvm.localdomain ให้ไปชี้ไปยัง /home/null/code/hhvm มาเริ่มกันเลย<br>\n</li>\n</ol>\n<p>6.1 โดยเริ่มจากการแก้ไข้ไฟล์ /etc/hosts ให้ domain hhvm.localdomain ชี้มาที่เครื่องเราเองดังภาพ  </p>\n<blockquote>\n<p>sudo nano /etc/hosts</p>\n</blockquote>\n<p>เพิ่ม 127.0.0.1  hhvm.localdomain เข้าไป  </p>\n<p><a href=\"http://1.bp.blogspot.com/-wfwVqELI-iY/VNXFWNqpg-I/AAAAAAAAUdY/vs1mW9E-Sx8/s1600/Screenshot-Terminal-7.png\"><img src=\"http://1.bp.blogspot.com/-wfwVqELI-iY/VNXFWNqpg-I/AAAAAAAAUdY/vs1mW9E-Sx8/s1600/Screenshot-Terminal-7.png\"></a>  </p>\n<p>6.2 สร้าง Config file virtual host ให้กับ Nginx โดย save file ไว้ที่ /etc/nginx/sites-available/hhvm.localdomain  </p>\n<p>config สำหรับ virutal host ตาม link นี้ครับ <a href=\"https://gist.github.com/kittinan/87f410004df45b6d0573\">https://gist.github.com/kittinan/87f410004df45b6d0573</a>  </p>\n<p>ตรง root path ก็แก้ให้ถูกต้องตามเครื่องใครเครื่องมันนะครับ  </p>\n<p>เสร็จแล้วสร้าง Sym link เพื่อเปิดการใช้งาน virtual host ที่ชื่อ hhvm.localdomain  </p>\n<blockquote>\n<p>sudo ln -s /etc/nginx/sites-available/hhvm.localdomain /etc/nginx/sites-enabled/hhvm.localdomain</p>\n</blockquote>\n<ol start=\"7\">\n<li>Restart Nginx  </li>\n</ol>\n<blockquote>\n<p>sudo /etc/init.d/nginx restart</p>\n</blockquote>\n<ol start=\"8\">\n<li>สร้างไฟล์ index.php ไว้ที่ root path ในที่นี่จะสร้างไฟล์ไว้ที่ /home/null/code/hhvm/index.php เพื่อทดสอบการ config ว่าใช้งานได้  </li>\n</ol>\n<blockquote>\n<?php  \necho \"Hello HHVM\";  \necho \"<br />\";  \nphpinfo();\n</blockquote>\n<p>เมื่อเสร็จแล้วลองเรียกผ่าน <a href=\"http://hhvm.localdomain/\">http://hhvm.localdomain/</a> ก็จะได้ output ดังภาพ<br>\n<a href=\"http://4.bp.blogspot.com/-wnzKqQdGq2Q/VNXMvJ5A9TI/AAAAAAAAUdo/e9AGsoCQDZ4/s1600/Screenshot-18.png\"><img src=\"http://4.bp.blogspot.com/-wnzKqQdGq2Q/VNXMvJ5A9TI/AAAAAAAAUdo/e9AGsoCQDZ4/s1600/Screenshot-18.png\"></a>  </p>\n<p>หากต้องการ phpinfo() แบบละเอียด hhvm มันไม่ได้จัดมาไว้ให้ครับต้องใช้ script ตัวนี้<br>\n<a href=\"https://gist.github.com/ck-on/67ca91f0310a695ceb65\">https://gist.github.com/ck-on/67ca91f0310a695ceb65</a> เมื่อนำมารันก็จะได้ดังภาพ  </p>\n<p><a href=\"http://2.bp.blogspot.com/-J2SMCiG7mGA/VNXNek4jpXI/AAAAAAAAUdw/70oURfRYIdQ/s1600/Screenshot-19.png\"><img src=\"http://2.bp.blogspot.com/-J2SMCiG7mGA/VNXNek4jpXI/AAAAAAAAUdw/70oURfRYIdQ/s1600/Screenshot-19.png\"></a>  </p>\n","title":"วิธีการติดตั้ง Nginx + HHVM บน Ubuntu 14.04","date":"2015-02-07 15:34:00"}},"__N_SSG":true}