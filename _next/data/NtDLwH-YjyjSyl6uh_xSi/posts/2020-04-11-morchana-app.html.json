{"pageProps":{"postData":{"id":"2020-04-11-morchana-app.html","contentHtml":"<p>เมื่อวันที่ 10 เมษายน 2563 ได้มีการเปิดตัวแอพ <strong><a href=\"https://www.blognone.com/node/115736\">หมอชนะ</a></strong> เพื่อเก็บประวัติการเดินทางของประชาชน และประเมินว่าบริเวณนั้นมีผู้ป่วย COVID-19 หรือไม่ ผมจึงทำการตรวจสอบว่ามีการส่งข้อมูลอะไรบ้างไปยัง Server  </p>\n<p>| <a href=\"https://1.bp.blogspot.com/-PF6LBTlfNlk/XpG0kZx-TaI/AAAAAAACATU/Nl4h1sMW4O0Z22Mvh9vsWSQA9pxxXoCRACNcBGAsYHQ/s1600/0568.jpg\"><img src=\"https://1.bp.blogspot.com/-PF6LBTlfNlk/XpG0kZx-TaI/AAAAAAACATU/Nl4h1sMW4O0Z22Mvh9vsWSQA9pxxXoCRACNcBGAsYHQ/s640/0568.jpg\"></a> |\n| รูปจาก <a href=\"https://www.prachachat.net/ict/news-447255\">https://www.prachachat.net/ict/news-447255</a> |</p>\n<p>วิธีการตรวจสอบเบื้องต้นคือการทำ Man In The Middle (MITM)  </p>\n<p>โดยมีการเรียก API ต่างๆดังนี้  </p>\n<p><strong>1. /registerDevice</strong>  </p>\n<p>โดยมีการส่งข้อมูลเป็น JSON ดังนี้  </p>\n<p>Request:  </p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span><span class=\"token property\">\"deviceId\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"XXXXXXXXXX\"</span><span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>โดยค่าใน deviceId น่าจะเป็นค่า hash จากอะไรบางอย่าง  </p>\n<p>Response:  </p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"userId\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"XXXXXXXXXX\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"anonymousId\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"XXXXXXXXXX\"</span>\n<span class=\"token punctuation\">}</span>  \n</code></pre></div>\n<p><strong>2. /userdata</strong>  </p>\n<p>มีการเรียกใช้เมื่อทำแบบทดสอบ  </p>\n<p>Request:  </p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"questionaire\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n         <span class=\"token property\">\"one_uri_symp\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"none\"</span>\n         <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"travel_risk_country\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"covid19_contact\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"none\"</span>\n         <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"int_contact\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span> \n</code></pre></div>\n<p><strong>3. /qr</strong>  </p>\n<p>เรียกเพื่อโหลด QRCode ของเรา โดยมีการส่ง anonymousId แนบไปกับ header ด้วย  </p>\n<p><strong>4. /location</strong>  </p>\n<p>อันนี้จะส่งข้อมูลพิกัดที่เราอยู่ไปยัง Server  </p>\n<p>Request:  </p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"locations\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n         <span class=\"token property\">\"is_moving\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"uuid\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"XXXX\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"2020-04-11T10:50:50.482Z\"</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"odometer\"</span><span class=\"token operator\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"coords\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"latitude\"</span><span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"longitude\"</span><span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"accuracy\"</span><span class=\"token operator\">:</span><span class=\"token number\">25.9</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"speed\"</span><span class=\"token operator\">:</span><span class=\"token number\">-1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"heading\"</span><span class=\"token operator\">:</span><span class=\"token number\">-1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"altitude\"</span><span class=\"token operator\">:</span><span class=\"token number\">-23.5</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"activity\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"still\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"confidence\"</span><span class=\"token operator\">:</span><span class=\"token number\">100</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"battery\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"is_charging\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"level\"</span><span class=\"token operator\">:</span><span class=\"token number\">0.38</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token property\">\"extras\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"triggerType\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"appState\"</span>\n         <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n   <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>  \n</code></pre></div>\n<p><strong>5. /scan</strong>  </p>\n<p>หากพบ device อื่นๆผ่าน Bluetooth  หรือการ scan QRCode ก็จะส่ง API อันนี้  </p>\n<div class=\"remark-highlight\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"meetId\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"XXXX\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"2020-04-11T11:06:53.777Z\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"meetWithIds\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"XXXX\"</span>\n   <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"latitude\"</span><span class=\"token operator\">:</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"longitude\"</span><span class=\"token operator\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"accuracy\"</span><span class=\"token operator\">:</span><span class=\"token number\">24.2</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"bluetooth\"</span>\n<span class=\"token punctuation\">}</span> \n</code></pre></div>\n<p><strong>6. <a href=\"https://raw.githubusercontent.com/codeforpublic/morchana-core/master/available\">https://raw.githubusercontent.com/codeforpublic/morchana-core/master/available</a></strong>  </p>\n<p>เป็น API Kill-Switch เอาไว้เมื่อเลิกเก็บข้อมูลผู้ใช้แล้ว ก็จะใช้งานแอพไมไ่ด้ ชอบตรงที่เก็บไว้บน Github  </p>\n<p><a href=\"https://1.bp.blogspot.com/--5pvypeMgXQ/XpGt_uV1rJI/AAAAAAACASU/1JASpLED7KYE1Xs4LReziGfg8MHOlfeuACNcBGAsYHQ/s1600/Screenshot_2020-04-11-14-57-40-973_com.thaialert.app.jpg\"><img src=\"https://1.bp.blogspot.com/--5pvypeMgXQ/XpGt_uV1rJI/AAAAAAACASU/1JASpLED7KYE1Xs4LReziGfg8MHOlfeuACNcBGAsYHQ/s640/Screenshot_2020-04-11-14-57-40-973_com.thaialert.app.jpg\"></a>  </p>\n<p><strong>สรุป</strong>  </p>\n<ul>\n<li>ไม่พบว่ามีการส่งรูปที่เราถ่ายขึ้นไปยังบน Server  </li>\n<li>ไม่พบว่ามีการส่งข้อมูลอื่นๆนอกเหนือจากที่ประกาศไว้  </li>\n<li>งั้นเรามาใช้แอพ หมอชนะ กันเถอะ<br>\nAppstore: <a href=\"https://apps.apple.com/th/app/allthaialert/id1505185420\">https://apps.apple.com/th/app/allthaialert/id1505185420</a><br>\nPlay Store: <a href=\"https://play.google.com/store/apps/details?id=com.thaialert.app\">https://play.google.com/store/apps/details?id=com.thaialert.app</a>  </li>\n</ul>\n","title":"ตรวจสอบแอพ \"หมอชนะ\" เบื้องต้น","date":"2020-04-11 18:38:00"}},"__N_SSG":true}